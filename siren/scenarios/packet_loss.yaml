name: "Packet Loss Simulation"
description: "Randomly drop packets to simulate network packet loss at various rates"

proxy:
    listen: ":8080"
    target: "server.example.com:80"
    protocol: tcp
    max_connections: 1000
    connection_timeout: "30s"
    buffer_size: 32768
    enable_logging: true

rules:
    # 1% packet loss (light)
    - name: "1% Packet Loss"
      enabled: false
      priority: 100
      match:
          direction: both
      action:
          type: drop
          probability: 0.01

    # 5% packet loss (moderate)
    - name: "5% Packet Loss"
      enabled: true
      priority: 100
      match:
          direction: both
      action:
          type: drop
          probability: 0.05

    # 10% packet loss (heavy)
    - name: "10% Packet Loss"
      enabled: false
      priority: 100
      match:
          direction: both
      action:
          type: drop
          probability: 0.10

    # 25% packet loss (severe)
    - name: "25% Packet Loss"
      enabled: false
      priority: 100
      match:
          direction: both
      action:
          type: drop
          probability: 0.25

    # Asymmetric loss: drop more server->client than client->server
    - name: "Asymmetric Loss"
      enabled: false
      priority: 90
      match:
          direction: server_to_client
      action:
          type: drop
          probability: 0.15

    # Drop large packets more aggressively
    - name: "Drop Large Packets"
      enabled: false
      priority: 110
      match:
          direction: both
          size_gt: 8192  # Packets larger than 8KB
      action:
          type: drop
          probability: 0.20

recording:
    enabled: false
    output: "captures/packet_loss.json"
    format: json
    include_payload: true
    max_file_size: "50MB"
    flush_interval: "5s"
