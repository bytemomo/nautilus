name: iot-lab
description: Default IoT client interception profile

ebpf:
    interface: lo
    drop_action_duration: 5ms
    targets:
        - "ip_port:127.0.0.1:9000"

rules:
    - name: log-all
      enabled: true
      match:
          direction: both
      action:
          type: log
          log:
              level: info
              message: "Siren saw packet"
              dump_payload: true

    - name: modify-token
      description: Rewrite leaked tokens before they reach the server
      enabled: true
      priority: 80
      match:
          direction: client_to_server
          content_contains: "TOKEN=OLD"
      action:
          type: modify
          modify:
              operation: replace
              pattern: "TOKEN=OLD"
              replacement: "TOKEN=SANITIZED"

recording:
    enabled: false
    output: siren-results/captures/iot-lab.pcap
    format: pcap
    include_payload: true
    flush_interval: 3s
    max_file_size: 250MB
