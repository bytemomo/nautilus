name: tls_checker
version: 1.0.0
description: TLS/SSL configuration and security checker
author: ORCA Security Team
license: MIT
homepage: https://github.com/orca/extensions/tls-checker

interface:
  type: inspector
  version: 1.0

backend:
  type: grpc
  config:
    grpc:
      port: 50051
      timeout: 30s
      max_recv_size: 4194304
      max_send_size: 4194304
      reflection: false

parameters:
  - name: min_version
    type: string
    description: Minimum required TLS version (1.0, 1.1, 1.2, 1.3)
    required: false
    default: "1.2"
    valid_values: ["1.0", "1.1", "1.2", "1.3"]
    examples: ["1.2", "1.3"]

  - name: reject_self_signed
    type: bool
    description: Reject self-signed certificates
    required: false
    default: true
    examples: [true, false]

  - name: check_expiration
    type: bool
    description: Check certificate expiration
    required: false
    default: true
    examples: [true, false]

  - name: expiration_warning_days
    type: int
    description: Days before expiration to trigger warning
    required: false
    default: 30
    min_value: 1
    max_value: 365
    examples: [30, 90]

  - name: allowed_ciphers
    type: array
    description: List of allowed cipher suites (empty = use defaults)
    required: false
    examples: [["ECDHE-RSA-AES128-GCM-SHA256", "ECDHE-RSA-AES256-GCM-SHA384"]]

  - name: forbidden_ciphers
    type: array
    description: List of forbidden cipher suites
    required: false
    examples: [["RC4", "DES", "3DES"]]

  - name: require_sni
    type: bool
    description: Require Server Name Indication (SNI)
    required: false
    default: false
    examples: [true, false]

  - name: check_ocsp
    type: bool
    description: Check OCSP stapling
    required: false
    default: false
    examples: [true, false]

  - name: check_ct_logs
    type: bool
    description: Check Certificate Transparency logs
    required: false
    default: false
    examples: [true, false]

  - name: timeout_seconds
    type: int
    description: Connection timeout in seconds
    required: false
    default: 10
    min_value: 1
    max_value: 300
    examples: [10, 30]

dependencies:
  - name: openssl
    version: ">=1.1.1"
    type: system
    description: OpenSSL library for TLS operations

  - name: go-tls
    version: ">=1.19"
    type: library
    description: Go TLS library

capabilities:
  - tls_handshake
  - certificate_validation
  - cipher_analysis
  - protocol_detection
  - vulnerability_scanning

tags:
  protocol: tls
  category: security
  compliance: "nist,pci-dss,hipaa"
  severity: high

metadata:
  supported_ports: [443, 8443, 9443, 8883, 993, 995, 465, 587, 636, 3389]
  common_services: [https, mqtt-tls, imaps, pop3s, smtps, ldaps, rdp-tls]
  check_types: [compliance, vulnerability, configuration]
  output_formats: [json, yaml, xml]
  references:
    - https://tools.ietf.org/html/rfc5246
    - https://tools.ietf.org/html/rfc8446
    - https://wiki.mozilla.org/Security/Server_Side_TLS
