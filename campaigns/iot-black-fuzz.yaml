id: "iot-fuzzing"
version: "1.0.0"

name: "IoT Fuzzing Assessment"
description: |
    README
    ======

    This campaign is used to automatically find fuzzable services in the network and then
    fuzz them with fine tuned modules for the said protocols, for now the supported protocols
    are:
        - MQTT
        - RTSP

    The campaign can require a lot of time to execute and also could find anything usefull.
    Each module handles alone the connection, fuzzing process and results savings. This mean
    that depending on the module the results could be saved with different formats.

    If possible, as you will see specified in the params of each module, it would be nice to
    give the modules access to the process that they are fuzzing.

    This is beacause a white box approach (code path analysis, and output analysis) could give
    more informations than a black box approach (that uses only a network response based approach).

    As this campaign concetrate in finding implementation bugs in the servers that uses this protocol
    it does not have an attack trees file.

    NOTE: NEVER use this campaign in a production environment as it will try to find unknown
    vulnerabilites in the protocols servers, this could lead to crashes and a downtime in the
    production environment. Even if the campaign does find any vulnerability the trafic generated
    could creates many allerts and flood the network making it more unstable.

policy:
    safety:
        allow_aggressive: true
        require_max_duration: true
    runner:
        max_parallel_targets: 2

scanners:
    - type: nmap
      nmap:
          open_only: true
          skip_host_discovery: false
          enable_udp: false
          service_detect:
              enabled: true
              version: ALL
          min_rate: 100
          timeout: 30m
          timing: T3
          ports:
              - "1883,8883,8083,8084,80,443,8000,8080,8443,8888,502,4840,554,8554,5672,5671,21,22,23,25,110,143,3128,3306,5432,6379,9002,9003"

tasks:
    - id: "mqtt-boofuzz"
      required_tags: ["protocol:mqtt"]
      max_duration: 5s
      type: cli
      exec:
          # The orchestrator will to set the --output-dir parameter automatically
          # so that the outputs of boofuzz will be placed in the right directory.
          cli:
              # There could be the need of root path
              exec: "./modules/kraken/fuzz/mqtt/boofuzz/boofuzz_poc.py"
              command: "fuzz"
          # Params will be translated in arguments, entry, e.g.:
          #     --test-case-index: 10-20
          # will be translated in: <exec> <command> --test-case-index: 10-20
          params:
              # test-case-index INTEGER     # Test case index
              # test-case-name TEXT         # Name of node or specific test case
              # csv-out TEXT                # Output to CSV file
              # sleep-between-cases FLOAT   # Wait time between test cases (floating point)
              # procmon-host TEXT           # Process monitor port host or IP
              # procmon-port INTEGER        # Process monitor port
              # procmon-start TEXT          # Process monitor start command
              # procmon-capture             # Capture stdout/stderr from target process upon failure
              # file-dump / no-file-dump    # Enable/disable full dump of logs into a file
              # help                        # Show this message and exit.
