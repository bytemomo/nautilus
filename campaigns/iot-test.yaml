id: "iot-test"
version: "2.0.0"

name: "IoT Network Assessment"
runner:
    max_parallel_targets: 16

scanner:
    open_only: true
    skip_host_discovery: false
    enable_udp: false
    service_detect:
        enabled: true
        version: "ALL"
    min_rate: 100
    timeout: 30m
    timing: T3
    ports:
        - "1883,8883,8083,8084,80,443,8000,8080,8443,8888,502,4840,554,8554,5672,5671,21,22,23,25,110,143,3128,3306,5432,6379,9002,9003,4423"

attack_trees_def_path: "./campaigns/trees/iot.yaml"

tasks:
    # - id: "mqtt-replay"
    #   required_tags: ["protocol:mqtt", "protocol:tcp"]
    #   max_duration: 1m
    #   type: lib
    #   exec:
    #       abi:
    #           api: v1
    #           library_path: "./modules/kraken/abi/mqtt_replay/build/mqtt_replay"
    #           symbol: kraken_run
    #       params:
    #           sequence_num: "1"
    #           path0: "./modules/kraken/abi/mqtt_replay/CVE-2024-8376.txt"

    # - id: "mqtt-conformance-test"
    #   required_tags: ["protocol:mqtt", "protocol:tcp"]
    #   max_duration: 10s
    #   type: native

    # - id: "rtsp-surface-scan"
    #   required_tags: ["protocol:rtsp", "protocol:tcp"]
    #   max_duration: 10s
    #   type: native
    #   exec:
    #      params:
    #           user_agent: "Kraken-RTSP/1.0"
    #           probe_paths: ["/", "/live.sdp", "/cam/realmonitor"]

    # - id: "mqtt-sys-disclosure"
    #   required_tags: ["protocol:mqtt", "protocol:tcp"]
    #   max_duration: 5s
    #   type: lib
    #   exec:
    #       abi:
    #           api: v1
    #           library_path: "./modules/kraken/abi/mqtt_sys_disclosure/build/mqtt_sys_disclosure"
    #           symbol: kraken_run

    - id: "rtsp-dict-attack"
      required_tags: ["protocol:rtsp", "protocol:tcp"]
      max_duration: 30s
      type: native
      exec:
          params:
              path: "/live.sdp"
              # credentials_file: "./wordlists/rtsp.txt"
              # credentials:
              #     - "admin:admin"
              #     - { username: "root", password: "pass" }

    - id: "mqtt-dict-attack"
      required_tags: ["protocol:mqtt", "protocol:tcp"]
      max_duration: 30s
      type: native
      exec:
          params:
              client_id: "kraken-dict"
              keep_alive: 30
              # credentials_file: "./wordlists/mqtt.txt"
              # credentials:
              #     - "admin:admin"
              #     - "user:password"
