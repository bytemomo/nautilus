- name: "Unauthorized Access Attempt"
  type: AND
  children:
      - name: "Bypass Authentication"
        type: OR
        children:
            - name: "Guess Password"
              type: LEAF
              finding_ids: ["pw-guess-v1"]
              finding_mode: any

            - name: "Token Reuse"
              type: LEAF
              finding_ids: ["token-checker-a", "token-checker-b"]
              finding_mode: any

            - name: "Chain of Plugins"
              type: LEAF
              finding_ids: ["p1", "p2", "p3"]
              finding_mode: threshold
              finding_threshold: 2

- name: "Data Exflirtation"
  type: AND
  children:
      - name: "Obtain MQTT valid Session"
        type: LEAF
        finding_ids: ["MQTT-ANON"] # TODO: Other possible findings
        finding_mode: any

      - name: "Broker Permissive PUBSUB"
        type: LEAF
        finding_ids: ["MQTT-PUBSUB"]
        finding_mode: any
