id: "iot-default"
name: "Default IoT Network Assessment"
version: "1.0.0"
scanner:
    # only report open ports
    open_only: true
    # -Pn
    skip_host_discovery: false
    # To have a faster execution
    enable_udp: false

    # -sV (will slow a bit down)
    # Setting this to false will hinder the scanning and the services fingerprinting
    # makeing the tool less powerfull on the tests it can do. But it will be significantly
    # faster.
    #
    # Then the fast vs light version can be choosen depending on what has to be done.
    service_detect: true
    version_all: false
    version_light: true

    min_rate: 100
    timeout: 30m
    timing: T3
    ports:
        - "1883,8883,8083,8084,80,443,8000,8080,8443,8888,502,4840,554,8554,5672,5671,21,22,23,25,110,143,3128,3306,5432,6379,9002,9003"

# Steps to execute against targets
steps:
    - plugin_id: "tls_version_check"
      required_tags: ["supports:tls", "protocol:tcp"]
      max_duration_s: 20
      exec:
          transport: abi
          abi:
              library: "./plugins/tls_version_check/build/tls_version_check"
              symbol: "ORCA_Run"

    - plugin_id: "default_password_audit"
      required_tags: ["protocol:tcp", "protocol:telnet"]
      max_duration_s: 20
      exec:
          transport: abi
          abi:
              library: "./plugins/telnet_default_creds/build/telnet_default_creds"
              symbol: "ORCA_Run"

    - plugin_id: "mqtt_auth_check"
      required_tags: ["protocol:mqtt"]
      exec:
          transport: abi
          abi:
              library: "./plugins/mqtt_auth_check/mqtt_auth_check"
              symbol: "ORCA_Run"
          params:
              creds_file: "./credentialdbs/creds.txt"

    - plugin_id: "cert_inspection"
      required_tags: ["supports:tls", "protocol:tcp"]
      max_duration_s: 15
      exec:
          transport: abi
          abi:
              library: "./plugins/cert_inspect/target/release/cert_inspect"
              symbol: "ORCA_Run"
          params:
              warn_days: 21
              match_hostname: true
              require_san: true
              min_rsa_bits: 2048
              allow_sha1: false
              require_server_auth: true
              disallow_self_signed: true
              print_certificates_stdout: true

    - plugin_id: "mqtt_boofuzz"
      required_tags: ["protocol:mqtt"]
      max_duration_s: 120
      exec:
          transport: cli
          cli:
              path: "./plugins/fuzzing/mqtt/boofuzz_poc.py"
