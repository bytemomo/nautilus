# PARTIAL SECURITY PROFILE - ACL Configuration
#
# This ACL has some restrictions but is still too permissive:
#
# Vulnerabilities:
# - Anonymous users can still read public topics
# - $SYS topics accessible to all authenticated users
# - Operator role has too broad access
# - Guest can read sensitive topics

# =============================================================================
# Anonymous Access (for port 1883)
# VULNERABLE: Anonymous can read some topics
# =============================================================================
topic read test/public/#
topic read ot/+/status/#

# =============================================================================
# Admin User - Full Access (expected)
# =============================================================================
user admin
topic readwrite #
topic read $SYS/#

# =============================================================================
# SCADA User
# PARTIAL: Should only access specific topics, but has broad read
# =============================================================================
user scada
topic readwrite ot/+/telemetry/#
topic readwrite ot/+/command/#
topic readwrite ot/+/alarm/#
topic read ot/+/status/#
topic read system/#
# VULNERABLE: Can read $SYS
topic read $SYS/#

# =============================================================================
# PLC User
# PARTIAL: Limited but can still read more than necessary
# =============================================================================
user plc
topic readwrite ot/plc/#
topic read ot/+/command/+
# VULNERABLE: Can read other device topics
topic read ot/rtu/status/#

# =============================================================================
# RTU User
# PARTIAL: Similar issues as PLC
# =============================================================================
user rtu
topic readwrite ot/rtu/#
topic read ot/+/command/+
# VULNERABLE: Can read other device topics
topic read ot/plc/status/#

# =============================================================================
# Operator User
# VULNERABLE: Too broad access for a low-privilege role
# =============================================================================
user operator
topic read #
topic write ot/+/command/#
# VULNERABLE: Can read $SYS
topic read $SYS/#

# =============================================================================
# Guest User
# VULNERABLE: Can read sensitive configuration topics
# =============================================================================
user guest
topic read test/#
topic read system/health/#
# VULNERABLE: Should not have access to config topics
topic read ot/config/#
