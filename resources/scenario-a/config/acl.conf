# Mosquitto ACL Configuration for Scenario A
# 
# This ACL demonstrates a partially secure configuration with some gaps
# that Kraken modules can detect.
#
# Topic Namespace:
#   ot/+/telemetry/#    - Telemetry data from field devices (read by SCADA)
#   ot/+/status/#       - Device status updates
#   ot/+/command/#      - Commands from SCADA to field devices
#   ot/+/alarm/#        - Alarm notifications
#   system/health/#     - System health metrics
#   $SYS/#              - Broker statistics (should be restricted)

# =============================================================================
# User: admin (full access for management)
# =============================================================================
user admin
topic readwrite #
topic readwrite $SYS/#

# =============================================================================
# User: scada (SCADA/HMI systems - can read telemetry, write commands)
# =============================================================================
user scada
topic read ot/+/telemetry/#
topic read ot/+/status/#
topic read ot/+/alarm/#
topic write ot/+/command/#
topic read system/health/#

# =============================================================================
# User: plc (PLC devices - can write telemetry, read commands)
# =============================================================================
user plc
topic write ot/plc/telemetry/#
topic write ot/plc/status/#
topic write ot/plc/alarm/#
topic read ot/plc/command/#

# =============================================================================
# User: rtu (RTU devices - can write telemetry, read commands)
# =============================================================================
user rtu
topic write ot/rtu/telemetry/#
topic write ot/rtu/status/#
topic write ot/rtu/alarm/#
topic read ot/rtu/command/#

# =============================================================================
# User: operator (read-only access for operators)
# =============================================================================
user operator
topic read ot/#
topic read system/health/#

# =============================================================================
# User: guest (intentionally weak - for testing ACL bypass)
# This user has overly permissive access that should be flagged
# =============================================================================
user guest
topic read #
topic write test/#

# =============================================================================
# Pattern-based ACL (for mTLS with CN as username)
# =============================================================================
pattern read ot/%u/telemetry/#
pattern write ot/%u/command/#
pattern readwrite ot/%u/status/#
